---
# URL of the release Pulp service's container image registry.
dev_release_pulp_registry_url: "{{ dev_pulp_url }}"

# Name of a tag to promote to a release.
# This must be defined when promoting images.
#dev_pulp_repository_container_promotion_tag:

# Common parameters for release image repositories.
dev_pulp_repository_container_repo_release_common:
  url: "{{ dev_release_pulp_registry_url }}"
  include_tags:
    - "{{ dev_pulp_repository_container_promotion_tag | mandatory }}"
  policy: on_demand
  remote_username: "{{ dev_pulp_username }}"
  remote_password: "{{ dev_pulp_password }}"
  state: present

# List of release container image repositories.
dev_pulp_repository_container_repos_release: >-
  {%- set repos = [] -%}
  {%- for base_distro in kolla_base_distros -%}
  {%- for image in kolla_container_images -%}
  {%- set image_repo = "stackhpc/" ~ base_distro ~ "-source-" ~ image -%}
  {%- set upstream_repo = "stackhpc-dev/" ~ base_distro ~ "-source-" ~ image -%}
  {%- set repo = {"name": image_repo, "upstream_name": upstream_repo} -%}
  {%- set _ = repos.append(dev_pulp_repository_container_repo_release_common | combine(repo)) -%}
  {%- endfor -%}
  {%- endfor -%}
  {{ repos }}

# Common parameters for development image distributions.
dev_pulp_distribution_container_development_common:
  private: true
  state: present

# List of development container image distributions.
dev_pulp_distribution_container_development: >-
  {%- set distributions = [] -%}
  {%- for base_distro in kolla_base_distros -%}
  {%- for image in kolla_container_images -%}
  {%- set image_repo = "stackhpc-dev/" ~ base_distro ~ "-source-" ~ image -%}
  {%- set distribution = {"name": image_repo, "base_path": image_repo} -%}
  {%- set _ = distributions.append(dev_pulp_distribution_container_development_common | combine(distribution)) -%}
  {%- endfor -%}
  {%- endfor -%}
  {{ distributions }}

# Common parameters for release image distributions.
dev_pulp_distribution_container_release_common:
  private: true
  state: present

# List of release container image distributions.
dev_pulp_distribution_container_release: >-
  {%- set distributions = [] -%}
  {%- for base_distro in kolla_base_distros -%}
  {%- for image in kolla_container_images -%}
  {%- set image_repo = "stackhpc/" ~ base_distro ~ "-source-" ~ image -%}
  {%- set distribution = {"name": image_repo, "repository": image_repo, "base_path": image_repo} -%}
  {%- set _ = distributions.append(dev_pulp_distribution_container_release_common | combine(distribution)) -%}
  {%- endfor -%}
  {%- endfor -%}
  {{ distributions }}
